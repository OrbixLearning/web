<article class="q-card">
    <header class="qc-head">
        <div class="qc-left">
            @if (hasIndex) {
            <span class="idx">Questão {{ index! + 1 }}</span>
            }
            <span class="type">{{ question.type | questionType }}</span>
            @if (questionData) {
            <o-text-button (onclick)="syllabusInfoPO.toggle($event);">Tópicos contemplados</o-text-button>
            <p-popover #syllabusInfoPO>
                <o-syllabus-tags [syllabus]="questionData.syllabus || []" />
            </p-popover>
            @if (questionData.document) {
            <span class="doc-name"
                [pTooltip]="'Esta questão foi gerada a partir do documento \'' + questionData.document!.name + '.' + questionData.document.extension + '\''">
                {{ questionData.document!.name + '.' + questionData.document.extension }}</span>
            }
            }
        </div>
        <div class="qc-right">
            @if (showSelect) {
            <mat-checkbox [checked]="selected" (change)="select.emit()"></mat-checkbox>
            }
            @if (showEdit) {
            <o-text-button (onclick)="edit.emit()">Editar</o-text-button>
            }
            @if (showRemove) {
            <o-text-button (onclick)="remove.emit()">Excluir</o-text-button>
            }
        </div>
    </header>

    <section class="qc-body">
        <div class="statement">
            <p>{{ question.statement }}</p>
        </div>

        @switch (question.type) {
        @case (questionTypeEnum.MULTIPLE_CHOICE) {
        <ul class="options">
            @for (opt of question.options; track opt) {
            <li class="option" [class.is-correct]="verifyAnswer(question, [opt])">
                <span class="bullet"></span>
                <span class="text">{{ opt }}</span>
            </li>
            }
        </ul>
        }

        @case (questionTypeEnum.MULTIPLE_SELECTION) {
        <ul class="options">
            @for (opt of question.options; track opt) {
            <li class="option" [class.is-correct]="question.answers.includes(opt)">
                <span class="check"></span>
                <span class="text">{{ opt }}</span>
            </li>
            }
        </ul>
        }

        @case (questionTypeEnum.TRUE_FALSE) {
        <div class="tf">
            <span class="chip" [class.is-correct]="verifyAnswer(question, ['true'])">Verdadeiro</span>
            <span class="chip" [class.is-correct]="verifyAnswer(question, ['false'])">Falso</span>
        </div>
        }

        @case (questionTypeEnum.OPEN_ENDED) {
        <mat-form-field appearance="outline" subscriptSizing="dynamic" class="open-ended">
            <mat-label>Resposta correta</mat-label>
            <textarea matInput rows="4" [value]="question.answers[0]" [disabled]="true" cdkTextareaAutosize></textarea>
        </mat-form-field>
        }
        }
    </section>
</article>