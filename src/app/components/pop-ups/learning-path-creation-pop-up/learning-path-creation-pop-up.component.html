@if (isLoading){
<o-loading [isLoading]="isLoading" />
}

<o-pop-up-header title="Criar rota de aprendizagem" />

<mat-dialog-content class="lpc-content">

    <form class="name-div" [formGroup]="forms.at(0)">
        <mat-form-field appearance="outline" subscriptSizing="dynamic">
            <mat-label>Nome da rota</mat-label>
            <input matInput formControlName="name" required />
        </mat-form-field>
    </form>

    <p-accordion class="accordion" [value]="['topics','type','customize']" [multiple]="true">
        <p-accordion-panel value="topics">
            <p-accordion-header>
                <div class="accordion-header">
                    <span>Tópicos</span>
                    @if (forms.at(1).valid) {
                    <mat-icon>check</mat-icon>
                    }
                </div>
            </p-accordion-header>
            <p-accordion-content>
                <div class="lpc-topics">
                    <o-syllabus [syllabus]="ctx.classroom?.syllabus" mode="select"
                        (syllabusMarked)="markSyllabus($event)" [presets]="ctx.classroom?.presets" />
                </div>
            </p-accordion-content>
        </p-accordion-panel>

        <p-accordion-panel class="center-panel" value="type">
            <p-accordion-header>
                <div class="accordion-header">
                    <span>Tipo</span>
                    @if (forms.at(2).valid) {
                    <mat-icon>check</mat-icon>
                    }
                </div>
            </p-accordion-header>
            <p-accordion-content>
                <form [formGroup]="forms.at(2)" class="lpc-type">
                    <button type="button" class="type-option"
                        [class.is-selected]="getFormControl(2,'type').value === learningPathTypeEnum.TEXT"
                        (click)="selectType(learningPathTypeEnum.TEXT)">TEXTO</button>

                    <button type="button" class="type-option"
                        [class.is-selected]="getFormControl(2,'type').value === learningPathTypeEnum.AUDIO"
                        (click)="selectType(learningPathTypeEnum.AUDIO)">ÁUDIO</button>

                    <button type="button" class="type-option"
                        [class.is-selected]="getFormControl(2,'type').value === learningPathTypeEnum.VIDEO"
                        (click)="selectType(learningPathTypeEnum.VIDEO)">VÍDEO</button>

                    <button type="button" class="type-option"
                        [class.is-selected]="getFormControl(2,'type').value === learningPathTypeEnum.QUESTION"
                        (click)="selectType(learningPathTypeEnum.QUESTION)">QUESTÃO</button>

                    <button type="button" class="type-option"
                        [class.is-selected]="getFormControl(2,'type').value === learningPathTypeEnum.FLASHCARD"
                        (click)="selectType(learningPathTypeEnum.FLASHCARD)">FLASHCARD</button>
                </form>
            </p-accordion-content>
        </p-accordion-panel>

        <p-accordion-panel value="customize">
            <p-accordion-header>
                <div class="accordion-header">
                    <span>Personalizar</span>
                    @if (forms.at(3).valid) {
                    <mat-icon>check</mat-icon>
                    }
                </div>
            </p-accordion-header>
            <p-accordion-content>
                <form [formGroup]="forms.at(3)" class="lpc-customize">
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Idioma</mat-label>
                        <mat-select formControlName="language">
                            <mat-option value="pt-BR">Português</mat-option>
                            <mat-option value="en-US">Inglês</mat-option>
                            <mat-option value="es-ES">Espanhol</mat-option>
                            <mat-option value="de-DE">Alemão</mat-option>
                            <mat-option value="fr-FR">Francês</mat-option>
                            <mat-option value="it-IT">Italiano</mat-option>
                        </mat-select>
                    </mat-form-field>

                    @if (getFormControl(2,'type').value === learningPathTypeEnum.TEXT) {
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Número aproximado de parágrafos</mat-label>
                        <input type="number" matInput formControlName="numberOfParagraphs" />
                    </mat-form-field>
                    <div class="topics-toggle-div">
                        <mat-slide-toggle formControlName="useTopics">Texto em tópicos</mat-slide-toggle>
                    </div>
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Formalidade</mat-label>
                        <mat-select formControlName="formality">
                            <mat-option value="formal">Formal</mat-option>
                            <mat-option value="medium">Mediana</mat-option>
                            <mat-option value="informal">Informal</mat-option>
                        </mat-select>
                    </mat-form-field>
                    }

                    @else if (getFormControl(2,'type').value === learningPathTypeEnum.AUDIO) {
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Duração aproximada em segundos</mat-label>
                        <input type="number" matInput formControlName="durationInSeconds" />
                    </mat-form-field>
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Formalidade</mat-label>
                        <mat-select formControlName="formality">
                            <mat-option value="formal">Formal</mat-option>
                            <mat-option value="medium">Mediana</mat-option>
                            <mat-option value="informal">Informal</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Voz</mat-label>
                        <mat-select formControlName="voice">
                            <mat-option [value]="audioVoiceEnum.ALLOY">Alloy</mat-option>
                            <mat-option [value]="audioVoiceEnum.ECHO">Echo</mat-option>
                            <mat-option [value]="audioVoiceEnum.FABLE">Fable</mat-option>
                            <mat-option [value]="audioVoiceEnum.ONYX">Onyx</mat-option>
                            <mat-option [value]="audioVoiceEnum.NOVA">Nova</mat-option>
                            <mat-option [value]="audioVoiceEnum.SHIMMER">Shimmer</mat-option>
                            <mat-option [value]="audioVoiceEnum.SAGE">Sage</mat-option>
                            <mat-option [value]="audioVoiceEnum.CORAL">Coral</mat-option>
                            <mat-option [value]="audioVoiceEnum.ASH">Ash</mat-option>
                        </mat-select>
                    </mat-form-field>
                    }

                    @else if (getFormControl(2,'type').value === learningPathTypeEnum.VIDEO) {
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Número de vídeos</mat-label>
                        <input type="number" matInput formControlName="numberOfVideos" />
                    </mat-form-field>
                    }

                    @else if (getFormControl(2,'type').value === learningPathTypeEnum.FLASHCARD) {
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Número de Flash Cards</mat-label>
                        <input type="number" matInput formControlName="numberOfCards" />
                    </mat-form-field>
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Nível</mat-label>
                        <mat-select formControlName="level">
                            <mat-option [value]="0">Iniciante</mat-option>
                            <mat-option [value]="1">Intermediário</mat-option>
                            <mat-option [value]="2">Avançado</mat-option>
                            <mat-option [value]="3">Especialista</mat-option>
                        </mat-select>
                    </mat-form-field>
                    }

                    @else if (getFormControl(2,'type').value === learningPathTypeEnum.QUESTION) {
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Número de Questões</mat-label>
                        <input type="number" matInput formControlName="numberOfQuestions" />
                    </mat-form-field>
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Nível</mat-label>
                        <mat-select formControlName="level">
                            <mat-option [value]="0">Iniciante</mat-option>
                            <mat-option [value]="1">Intermediário</mat-option>
                            <mat-option [value]="2">Avançado</mat-option>
                            <mat-option [value]="3">Especialista</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field appearance="fill" subscriptSizing="dynamic">
                        <mat-label>Tipos de Questões</mat-label>
                        <mat-select formControlName="questionTypes" multiple>
                            <mat-option [value]="questionTypeEnum.MULTIPLE_CHOICE">Múltipla Escolha</mat-option>
                            <mat-option [value]="questionTypeEnum.MULTIPLE_SELECTION">Múltipla Seleção</mat-option>
                            <mat-option [value]="questionTypeEnum.TRUE_FALSE">Verdadeiro ou Falso</mat-option>
                            <mat-option [value]="questionTypeEnum.OPEN_ENDED">Aberta</mat-option>
                        </mat-select>
                    </mat-form-field>
                    }

                </form>
            </p-accordion-content>
        </p-accordion-panel>
    </p-accordion>

</mat-dialog-content>

<o-pop-up-buttons (confirm)="createLearningPath()" confirmButton="Criar" [disable]="forms.invalid" />