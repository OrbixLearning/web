<div class="pop-up-container">
  <o-pop-up-header title="Adicionar Novo Membro" />
  <o-loading [isLoading]="isLoading" />

  <div class="pop-up-content">
    
    <div class="search-bar">
      <mat-icon>search</mat-icon>
      <input 
        type="text" 
        placeholder="Insira nome ou email para buscar..." 
        [(ngModel)]="filter"
        (keyup.enter)="search()"
      />
    </div>

    <div class="search-results-container">
      @for (user of filteredUsers; track user.id) {
        <div class="user-result-card" (click)="selectUser(user)">
          <div class="user-info">
            <span class="user-name">{{ user.user.name }}</span>
            <span class="user-email">{{ user.email }}</span>
          </div>
        </div>
      } @empty {
        @if (showMessage && filter) {
          <p class="empty-message">Nenhum usu√°rio encontrado</p>
        }
      }
    </div>

    @if(selectedUsers.length > 0) {
      <div class="selected-users-container">
        <h3 class="selected-title">Membros a serem adicionados ({{ selectedUsers.length }})</h3>
        <div class="selected-users-list">
          @for (user of selectedUsers; track user.id) {
            <div class="selected-user-card">
              <span class="user-name">{{ user.user.name }}</span>
              <button mat-icon-button (click)="removeUser(user)" class="remove-btn">
                <mat-icon>close</mat-icon>
              </button>
            </div>
          }
        </div>
      </div>
    }
  </div>

  <o-pop-up-buttons 
    cancelButton="Cancelar" 
    confirmButton="Adicionar Membro" 
    [disable]="isLoading || selectedUsers.length === 0"
    (confirm)="addUsersToClassroom()" 
  />
</div>